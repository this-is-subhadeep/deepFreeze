<div @fadeIn class="selling-data-div mat-elevation-z10">
  <div class='inner-boundary'>
    <div class='header-row'>
      <mat-form-field>
        <mat-select required [(ngModel)]="selectedVendorId" name="vendor" #vendorList="ngModel" id="vendorList"
          placeholder="Vendor">
          <mat-option *ngFor="let completeVendor of completeVendors" [value]="completeVendor.id">
            {{completeVendor.name}}
          </mat-option>
        </mat-select>
        <mat-hint>Vendor to Sell to !!</mat-hint>
        <mat-error *ngIf="vendorList.invalid && vendorList.errors.required">
          Please select a Vendor !!
        </mat-error>
      </mat-form-field>
      <div [hidden]='!isVendorSelected()'>
        <mat-form-field>
          <input matInput type="number" pattern="^[0-9]+(\.[0-9]{1,2})?$" [(ngModel)]="selectedVendor.deposit" name="deposit"
            #deposit="ngModel" id="deposit" placeholder="Deposit">
          <mat-error *ngIf="deposit.invalid && deposit.errors.pattern">
            Deposit is not of currency format
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <table [hidden]='hideProductTable()'>
      <tr>
        <td>
          <mat-card>
            <strong>Product</strong>
          </mat-card>
        </td>
        <td>
          <mat-card>
            <strong>Units Sold</strong> : {{getTotalUnitsSold()}}
          </mat-card>
        </td>
        <td>
          <mat-card>
            <strong>Total Price</strong> : {{getTotalAmountSold()}}
          </mat-card>
        </td>
        <td>
          <mat-card>
            <strong>Action</strong>
          </mat-card>
        </td>
      </tr>
      <tr *ngFor="let sellingProduct of sellingProductList; let i = index">
        <td>
          <mat-expansion-panel>
            <mat-expansion-panel-header class='product-panel-header'>
              <mat-panel-title style="align-items: center">
                <span>
                  {{sellingProduct.product.name}}
                </span>
              </mat-panel-title>
              <mat-panel-description>
                {{sellingProduct.product.productType.name}}
              </mat-panel-description>
            </mat-expansion-panel-header>

            <mat-form-field>
              <input matInput [value]="sellingProduct.product.packageSize" name="packageSize" id="packageSize"
                placeholder="Size" disabled>
            </mat-form-field>

            <mat-form-field>
              <input matInput [value]="sellingProduct.product.costPrice" name="costPrice" id="costPrice" placeholder="Cost"
                disabled>
            </mat-form-field>

            <mat-form-field>
              <input matInput [value]="sellingProduct.product.sellingPrice" name="sellingPrice" id="sellingPrice"
                placeholder="Selling" disabled>
            </mat-form-field>

          </mat-expansion-panel>
        </td>
        <td>
          <mat-card class='ven-value-card'>
            <mat-form-field>
              <input matInput type="number" maxlength="5" [(ngModel)]="sellingProduct.soldUnits">
              <span matSuffix>/{{getStockBalance(sellingProduct.product.id)}}</span>
            </mat-form-field>
          </mat-card>
        </td>
        <td>
          <mat-card class='price-card'>
            <label>Price : {{sellingProduct.getSoldPrice()}}</label>
          </mat-card>
        </td>
        <td>
          <mat-card class='action-card'>
            <button mat-button type='button' (click)='deleteProductFromLIst(i)'>
              <mat-icon aria-label="Side nav toggle icon">delete</mat-icon>
            </button>
          </mat-card>
        </td>
      </tr>
    </table>
    <div [hidden]='!isVendorSelected()'>
      <div class="product-action-row">
        <mat-form-field appearance="outline">
          <mat-select required [(value)]="sellingProductId" #productList name="sellingProduct" id="productList"
            placeholder="Product">
            <mat-option value=""></mat-option>
            <mat-option *ngFor="let completeProduct of completeProducts" [value]="completeProduct.id">
              {{completeProduct.name + ' - ' +completeProduct.productType.name}}
            </mat-option>
          </mat-select>
          <mat-hint>Product to Sell !!</mat-hint>
          <mat-error *ngIf="productList.invalid && productList.errors.required">
            Please select a Product to sell !!
          </mat-error>
        </mat-form-field>
        <div class="button-group">
          <button mat-raised-button color='primary' type="button" (click)="saveButtonPressed()">
            Save
          </button>
          <button mat-raised-button color='accent' type="button" (click)="saveAndBillButtonPressed()">
            Save & Bill
          </button>
        </div>
      </div>
    </div>
  </div>
</div>